@model WebApi.Models.Statistique

<h4>@Html.DisplayFor(model => model.TitreFormulaire)</h4>

<table class="table">
    <thead>
        <tr>
            <td>
                <h4><b>Statistiques Globales</b></h4>
            </td>
        </tr>
        <tr></tr>
    </thead>
    <tbody>
        <tr>
            <td>
                @Html.DisplayFor(model => model.NbSondes) Personne(s) a/ont répondu à ce questionnaire
            </td>
            <td></td>
        </tr>
</table>
<div>
    <p>test</p>
    <div id="piechart" style="float:left;width:33%"></div>
    <div id="Sexe" style="float:left;width:33%"></div>
    <div id="Localisation" style="float:left;width:33%"></div>
</div>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script type="text/javascript">
// Load google charts
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

// Draw the chart and set the chart values
        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Age', '%']
      @{ string output = string.Empty;
          foreach (var item in Model.TauxAge)
          {

              if (item.Age != null)
              {
                  output += string.Format(",['{0} ans', {1}]", item.Age, item.Taux);
              }
              else
              {
                  output += string.Format(",['Non renseigné', {0}]", item.Taux);

              }
          }

                  @Html.Raw(output)

}
            ]);

            // Optional; add a title and set the width and height of the chart
            var options = { 'title': 'Ages des personnes sondées', 'width': 450, 'height': 400 };

            // Display the chart inside the <div> element with id="piechart"
            var chart = new google.visualization.PieChart(document.getElementById('piechart'));
            chart.draw(data, options);



            var data2 = google.visualization.arrayToDataTable([
                ['Age', '%']
      @{ string output2 = string.Empty;
          foreach (var item in Model.TauxSexe)
          {

              string sex = "Non renseigné";
              if (item.Sexe == false) { sex = "Homme"; }
              else if (item.Sexe == true) { sex = "Femme"; }
              output2 += string.Format(",['{0}', {1}]", sex, item.Taux);

          }

                  @Html.Raw(output2)

}
            ]);

            // Optional; add a title and set the width and height of the chart
            options = { 'title': 'Répartition des sondés', 'width': 450, 'height': 400 };

            // Display the chart inside the <div> element with id="piechart"
             chart = new google.visualization.PieChart(document.getElementById('Sexe'));
            chart.draw(data2, options);

             var data3 = google.visualization.arrayToDataTable([
                ['Age', '%']
      @{ string output3 = string.Empty;
          double total = 0;
          foreach (var item in Model.TauxLocalisation)
          {
              if (string.IsNullOrEmpty(item.Localisation))
              {
                  total += item.Taux;

              }
              if (!string.IsNullOrWhiteSpace(item.Localisation))
              {

                  output3 += string.Format(",['{0}', {1}]", item.Localisation, item.Taux);

              }
          }


          output3 += string.Format(",['Non Renseigné', {0}]", total);


                  @Html.Raw(output3)
          }

            ]);

            // Optional; add a title and set the width and height of the chart
             options = { 'title': 'Localisation des sondés', 'width': 450, 'height': 400 };

            // Display the chart inside the <div> element with id="piechart"
             chart = new google.visualization.PieChart(document.getElementById('Localisation'));
            chart.draw(data3, options);
        }
</script>




@*<div>
        <div style="float:left;width:33%">
            <table class="table">
                <thead>
                    <tr>
                        <td><b>Age</b></td>
                        <td></td>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model.TauxAge)
                                {
                                    if (item.Age != null)
                                    {
                    <tr>
                        <td width="30%">
                            @item.Age ans
                        </td>
                        <td width="70%">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="@item.Taux" aria-valuemin="0" aria-valuemax="100" style="width:@item.Taux.ToString().Replace(",", ".")%">@Convert.ToDouble(item.Taux)%</div>
                            </div>
                        </td>
                    </tr>

                                    }
                                    else
                                    {
                    <tr>
                        <td width="30%">
                            Age non renseigné
                        </td>
                        <td width="70%">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="@item.Taux" aria-valuemin="0" aria-valuemax="100" style="width:@item.Taux.ToString().Replace(",", ".")%">@Convert.ToDouble(item.Taux)%</div>
                            </div>
                        </td>
                    </tr>}
                                }
                    <tr>
                </tbody>
            </table>
        </div>

        <div style="float:left;width:33%">
            <table class="table">
                <thead>
                    <tr>
                        <td><b>Sexe</b></td>
                        <td></td>
                    </tr>
                </thead>

                <tbody>
                    @foreach (var item in Model.TauxSexe)
                                {

                                    if (item.Sexe == false)
                                    {
                    <tr>
                        <td width="30%">
                            Homme
                        </td>
                        <td width="70%">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="@item.Taux" aria-valuemin="0" aria-valuemax="100" style="width:@item.Taux.ToString().Replace(",", ".")%">@Convert.ToDouble(item.Taux)%</div>
                            </div>
                        </td>
                    </tr>
                                    }
                                    if (item.Sexe == true)
                                    {
                    <tr>
                        <td width="30%">
                            Femme
                        </td>
                        <td width="70%">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="@item.Taux" aria-valuemin="0" aria-valuemax="100" style="width:@item.Taux.ToString().Replace(",", ".")%">@Convert.ToDouble(item.Taux)%</div>
                            </div>

                        </td>
                    </tr>
                                    }
                                    if (item.Sexe == null)
                                    {
                    <tr>
                        <td width="30%">
                            Non renseigné
                        </td>
                        <td width="70%">
                            <div class="progress">
                                <div class="progress-bar" role="progressbar" aria-valuenow="@item.Taux" aria-valuemin="0" aria-valuemax="100" style="width:@item.Taux.ToString().Replace(",", ".")%">@Convert.ToDouble(item.Taux)%</div>
                            </div>
                        </td>
                    </tr>
                                    }
                                }
                </tbody>
            </table>
        </div>
        <tr>
            <div style="float:left;width:33%">
                <table class="table">
                    <thead>
                        <tr>
                            <td><b>Localisation</b></td>
                            <td></td>
                        </tr>
                    </thead>

                    <tbody>
                        @{
                                                double total = 0;


                        }

                        @foreach (var item in Model.TauxLocalisation)
                                        {
                                            if (string.IsNullOrEmpty(item.Localisation))
                                            {
                                                total += item.Taux;


                                            }
                                            if (!string.IsNullOrWhiteSpace(item.Localisation))
                                            {
                        <tr>
                            <td width="30%">
                                @item.Localisation
                            </td>
                            <td width="70%">
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" aria-valuenow="@item.Taux" aria-valuemin="0" aria-valuemax="100" style="width:@item.Taux.ToString().Replace(",", ".")%">@Convert.ToDouble(item.Taux)%</div>
                                </div>
                            </td>
                        </tr>
                                            }
                                        }
                        <tr>
                            <td width="30%">
                                Non renseigné
                            </td>
                            <td width="70%">
                                <div class="progress">
                                    <div class="progress-bar" role="progressbar" aria-valuenow="@total" aria-valuemin="0" aria-valuemax="100" style="width:@total.ToString().Replace(",", ".")%">@Convert.ToDouble(total)%</div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

    </div>*@
<table class="table">
    <thead>
        <tr>
            <td>
                <h4><b>Réponses aux questionnaire</b></h4>
            </td>
            <td></td>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.TauxChoixReponse)
        {
            <tr>
                <td><b>@item.Contenu</b></td>
                <td></td>
            </tr>

            foreach (var reponse in item.Reponses)
            {
                <tr>
                    <td width="30%"> &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;@reponse.Contenu</td>
                    <td width=" =70%">
                        <div class="progress">
                            <div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width:@reponse.Taux.ToString().Replace(",", ".")%">@Convert.ToDouble(reponse.Taux)%</div>
                        </div>
                    </td>

                </tr>
            }
        }






    </tbody>


</table>

